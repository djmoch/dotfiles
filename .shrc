#
# ~/.shrc
#
# vim: ft=sh
[ -r "$HOME/.shrc.local" ] && . "$HOME/.shrc.local"

set -o emacs
printf "\033]0;$LOGNAME@$HOSTNAME\007"

__ps1() {
	echo -n $LOGNAME@$HOSTNAME:
	if [ "$PWD" = "$HOME" ]
	then
		echo -n '~'
	else
		echo -n $(basename $PWD)
	fi

	if type git > /dev/null 2>&1
	then
		if git rev-parse --show-toplevel > /dev/null 2>&1
		then
			gitref=$(git rev-parse --abbrev-ref HEAD 2>/dev/null)
			[ $? -ne 0 ] && gitref="GIT: empty"
			[ "$gitref" = HEAD ] && gitref=\($(git rev-parse --short HEAD)\)
			echo " ($gitref)"
		else
			echo
		fi
	fi
}
PS1='$(__ps1)\$ '
export PS1

num() {
	pr -tn "$1" | $PAGER
}
proj() {
	if [ -d "$HOME/Documents/src/$1" ]
	then
		cd "$HOME/Documents/src/$1"
		[ -f .env ] && . ./.env
	fi
}

alias ll="ls -l"
alias la="ls -A"
alias lla="ls -lA"
alias tas="tmux attach-session -t"
alias tns="tmux new-session -s"
alias tls="tmux list-sessions"
alias ts="tmux-session"
alias psh="pass show"
alias pc="pass -c"
alias pls="pass ls"
alias feh="feh --auto-rotate --scale-down"
alias rsync="rsync -C --include=.git/"
alias ag="ag -p ~/.cvsignore"
alias pacupdates="cat /run/motd.pacman"
alias psu="ps -U $LOGNAME"

if [ "$VISUAL" = "vi" ]
then
	alias vim="vi"
fi

case `uname -s` in
	*Darwin*)
		alias jackd="jackd -d coreaudio > /dev/null 2>&1 &"
		;;
esac

if echo $LANG | grep UTF-8 > /dev/null 2>&1
then
	alias screen="screen -U"
fi

if type gpg-connect-agent > /dev/null 2>&1
then
	GPG_TTY=`tty`; export GPG_TTY
	gpg-connect-agent updatestartuptty /bye > /dev/null 2>&1
fi

if [ ! -f "$HOME/.hushlogin" ]
then
	if [ -r /etc/motd -a -n "$DISPLAY" -a -z "$SSH_TTY" ]
	then
		[ $SHLVL -le 1 ] && cat /etc/motd
	fi
fi
