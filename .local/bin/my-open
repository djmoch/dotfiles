#!/bin/sh
#
# ~/.local/bin/my-open
#
# Every OS seems to use it's own uniquely-named binary to open
# files using the correct handler for the file's MIME type. This is my
# attempt to resolve the different handlers into a platform-independent
# one.
#
if [ "$1" = "-T" ]
then
    shift
    for b in w3m lynx
    do
        if type $b > /dev/null 2>&1
        then
            browser=$b
            break
        fi
    done
    $browser $1
    exit
fi

# Find handler, if one is available
if type cygstart > /dev/null 2>&1
then
    handler=cygstart
elif type xdg-open > /dev/null 2>&1
then
    handler=xdg-open
# Most of the following handlers are used within xdg-open, but we should
# check for them anyway since xdg-open doesn't exist
elif type exo-open > /dev/null 2>&1
then
    handler=exo-open
# Because of its ambiguity, open (the macOS handler) should always be
# tested last
elif type open > /dev/null 2>&1
then
    handler=open
else
    echo "my-open: No suitable handler found" > /dev/stderr
    exit -1
fi

$handler $@
